{
  "version": "1.0",
  "description": "RIF Branch Protection Configuration - Single source of truth for branch protection rules",
  "repository": "RIF",
  "branches": {
    "main": {
      "protection": {
        "required_status_checks": {
          "strict": true,
          "contexts": [
            "Code Quality Analysis",
            "Security Scanning", 
            "Test Coverage",
            "Performance Testing",
            "RIF Validation"
          ]
        },
        "enforce_admins": false,
        "required_pull_request_reviews": {
          "required_approving_review_count": 1,
          "dismiss_stale_reviews": true,
          "require_code_owner_reviews": false,
          "dismissal_restrictions": {},
          "bypass_pull_request_allowances": {}
        },
        "restrictions": null,
        "required_linear_history": false,
        "allow_force_pushes": false,
        "allow_deletions": false,
        "block_creations": false,
        "required_conversation_resolution": true,
        "lock_branch": false,
        "allow_fork_syncing": true
      },
      "auto_merge_settings": {
        "allow_auto_merge": true,
        "delete_branch_on_merge": true,
        "allow_merge_commit": true,
        "allow_squash_merge": true,
        "allow_rebase_merge": false,
        "merge_commit_title": "MERGE_MESSAGE",
        "merge_commit_message": "PR_TITLE",
        "squash_merge_commit_title": "COMMIT_OR_PR_TITLE",
        "squash_merge_commit_message": "COMMIT_MESSAGES"
      },
      "progressive_activation": {
        "enabled": true,
        "current_step": 0,
        "total_steps": 5,
        "steps": [
          {
            "id": 1,
            "name": "require_pull_requests",
            "description": "Enable pull request requirement",
            "config": {
              "required_pull_request_reviews": {
                "required_approving_review_count": 0,
                "dismiss_stale_reviews": false,
                "require_code_owner_reviews": false
              }
            },
            "test": {
              "description": "Attempt direct push to main (should fail)",
              "expected_result": "blocked_with_clear_error"
            }
          },
          {
            "id": 2,
            "name": "require_reviews",
            "description": "Enable required reviews and stale review dismissal",
            "config": {
              "required_pull_request_reviews": {
                "required_approving_review_count": 1,
                "dismiss_stale_reviews": true,
                "require_code_owner_reviews": false
              }
            },
            "test": {
              "description": "Create test PR, verify review requirement",
              "expected_result": "merge_blocked_until_review"
            }
          },
          {
            "id": 3,
            "name": "require_status_checks",
            "description": "Enable all required status checks",
            "config": {
              "required_status_checks": {
                "strict": true,
                "contexts": [
                  "Code Quality Analysis",
                  "Security Scanning",
                  "Test Coverage", 
                  "Performance Testing",
                  "RIF Validation"
                ]
              }
            },
            "test": {
              "description": "Create test PR, trigger all quality gates",
              "expected_result": "merge_blocked_until_all_checks_pass"
            }
          },
          {
            "id": 4,
            "name": "require_up_to_date",
            "description": "Enable branch up-to-date requirement",
            "config": {
              "required_status_checks": {
                "strict": true
              }
            },
            "test": {
              "description": "Create outdated branch PR",
              "expected_result": "update_required_before_merge"
            }
          },
          {
            "id": 5,
            "name": "enable_auto_features",
            "description": "Enable auto-merge and branch deletion",
            "config": {
              "allow_auto_merge": true,
              "delete_branch_on_merge": true,
              "required_conversation_resolution": true
            },
            "test": {
              "description": "Complete PR with all requirements met",
              "expected_result": "auto_merge_and_branch_deletion"
            }
          }
        ]
      }
    }
  },
  "emergency_procedures": {
    "override_enabled": true,
    "override_roles": ["admin", "owner"],
    "override_audit_log": ".github/branch-protection-emergency-log.json",
    "rollback_script": "scripts/rollback_branch_protection.py",
    "emergency_contacts": [
      "PMI-CAL"
    ],
    "override_reasons": [
      "critical_security_patch",
      "emergency_hotfix",
      "system_outage_recovery",
      "deployment_blocker"
    ]
  },
  "monitoring": {
    "audit_enabled": true,
    "audit_log_path": ".github/branch-protection-audit.json",
    "metrics_collection": true,
    "alerts": {
      "protection_disabled": true,
      "emergency_override_used": true,
      "repeated_failures": true
    }
  },
  "metadata": {
    "created": "2025-08-24T00:00:00Z",
    "created_by": "RIF-Implementer",
    "issue": "203",
    "last_updated": "2025-08-24T00:00:00Z",
    "version_history": [
      {
        "version": "1.0",
        "date": "2025-08-24T00:00:00Z",
        "changes": "Initial configuration for GitHub branch protection rules",
        "agent": "RIF-Implementer"
      }
    ]
  }
}